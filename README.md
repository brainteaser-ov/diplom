# –ì–ª—É–±–æ–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ –≤ –∑–∞–¥–∞—á–µ –ø–æ–∏—Å–∫–∞ –∫–æ–≥–Ω–∞—Ç–æ–≤ –≤ –º–∞–ª–æ—Ä–µ—Å—É—Ä—Å–Ω—ã—Ö —è–∑—ã–∫–∞—Ö

<p align="center">
  <a href="#–æ-–ø—Ä–æ–µ–∫—Ç–µ">–û –ø—Ä–æ–µ–∫—Ç–µ</a> ‚Ä¢
  <a href="#–∑–∞–ø—É—Å–∫-–ø—Ä–æ–µ–∫—Ç–∞">–ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞</a> ‚Ä¢
  <a href="#—Å—Ç–µ–∫">–°—Ç–µ–∫</a> ‚Ä¢

<p align="center">
  <img src="/Flag-maps_of_the_subjects_of_Russia.png" alt="Siamese Text Classification
" width="738">
</p>


### –û –ø—Ä–æ–µ–∫—Ç–µ 
–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏–∞–º—Å–∫–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –∑–∞–¥–∞—á –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞. –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ö–æ–¥—Å—Ç–≤–∞ –º–µ–∂–¥—É –ø–∞—Ä–∞–º–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –∏ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö –ø–∞—Ä –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π.

> [!IMPORTANT]
> –í –∫–∞—á–µ—Å—Ç–≤–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–≥–Ω–∞—Ç–æ–≤ –º–∞–ª–æ—Ä–µ—Å—É—Ä—Å–Ω—ã—Ö —è–∑—ã–∫–æ–≤ –†–æ—Å—Å–∏–∏ (–º–∞–Ω—Å–∏–π—Å–∫–∏–π, —Å–∞–º–æ–¥–∏–π—Å–∫–∏–π, –∫–æ–º–∏-–ø–µ—Ä–º—è—Ü–∫–∏–π –∏ —Ç–¥.), –∞ —Ç–∞–∫–∂–µ –æ—Ç–∫—Ä—ã—Ç—ã–π –¥–∞—Ç–∞—Å–µ—Ç [CogNet](https://github.com/kbatsuren/CogNet). –î–∞—Ç–∞—Å–µ—Ç –±—ã–ª –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω –≤ –ø–∞—Ä—ã —Å–ª–æ–≤ –≤–∏–¥–∞: —Å–ª–æ–≤–æ —Å–ª–æ–≤–æ –º–µ—Ç–∫–∞ (–¥–ª—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä), –¥–ª—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä –±—ã–ª —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –¥–∞—Ç–∞—Å–µ—Ç —Ç–∞–∫–æ–≥–æ –∂–µ –≤–∏–¥–∞, –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –¥–∞—Ç–∞—Å–µ—Ç—ã –±—ã–ª–∏ –≤—ã—Ä–∞–≤–Ω–µ–Ω—ã –ø–æ –¥–ª–∏–Ω–µ. –û–±—â–∞—è –¥–ª–∏–Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ —Å–æ—Å—Ç–∞–≤–∏–ª–∞ –æ–∫–æ–ª–æ 4 –º–ª–Ω. –ø–∞—Ä (–ø–æ 2 –º–ª–Ω. –¥–ª—è –∫–∞–∂–¥–æ–π –º–µ—Ç–∫–∏ 1/0).

> [!IMPORTANT]
> –ü—Ä–∏ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏ —Ç–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ –ø–æ–ª—É—á–∏–ª–∞—Å—å –¥–æ–≤–æ–ª—å–Ω–æ –Ω–∏–∑–∫–∞—è (62%), –ø–æ—ç—Ç–æ–º—É –±—ã–ª —Å–æ–∑–¥–∞–Ω [–Ω–æ–≤—ã–π –¥–∞—Ç–∞—Å–µ—Ç](https://github.com/brainteaser-ov/diplom/blob/main/all_text.txt), –≤–∫–ª—é—á–∞—é—â–∏–π 200 —Ç—ã—Å. –∑–∞–ø–∏—Å–µ–π –∏ —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ –ø–∞—Ä —Å–ª–æ–≤ —Å –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏, –¥–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ [—Ñ–∞–π–ª–µ](https://github.com/brainteaser-ov/diplom/blob/main/torch_cognates2.ipynb) –∏ –Ω–æ–≤–∞—è [–º–æ–¥–µ–ª—å](https://github.com/brainteaser-ov/diplom/blob/main/model_full.pth) –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–æ–∫–æ–ª–æ 90%).


## –ó–∞–ø—É—â–µ–Ω–Ω–∞—è [–º–æ–¥–µ–ª—å](https://cognates.hopto.org)
–í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –∑–∞–ø—É—â–µ–Ω—ã –¥–≤–µ –º–æ–¥–µ–ª–∏, *—Å–µ—Ç—å 1* (–¥–æ–æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å) –∏ *—Å–µ—Ç—å 2* (–ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å), –ø—Ä–∏ –≤–≤–æ–¥–µ –ø–∞—Ä—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ: 
```
—Å–ª–æ–≤–æ:–ø–µ—Ä–µ–≤–æ–¥
```
–∏ —Å–ø–∏—Å–∫–∞ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ:

```
—Å–ª–æ–≤–æ:–ø–µ—Ä–µ–≤–æ–¥, —Å–ª–æ–≤–æ:–ø–µ—Ä–µ–≤–æ–¥, —Å–ª–æ–≤–æ:–ø–µ—Ä–µ–≤–æ–¥ –∏ —Ç.–¥.
```

–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ - –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ —Å–ª–æ–≤–∞ –∫–æ–≥–Ω–∞—Ç—ã (—Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ).

#### [–û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏](https://github.com/brainteaser-ov/diplom/blob/main/torch_cognates.ipynb)

`–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞` –º–æ–¥–µ–ª–∏ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
1. **Embedding Layer**: –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∏–º–≤–æ–ª–æ–≤ –≤ –ø–ª–æ—Ç–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è.
2. **Position Embedding**:–î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ —ç–º–±–µ–¥–∏–Ω–≥–∏ –∫ –≤—Ö–æ–¥–Ω—ã–º —ç–º–±–µ–¥–∏–Ω–≥–∞–º, —á—Ç–æ–±—ã –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Å–∏–º–≤–æ–ª–æ–≤ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
3. **Spatial Dropout**: –ü—Ä–∏–º–µ–Ω—è–µ—Ç dropout –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏.
4. **Bidirectional LSTM**: –ü—Ä–∏–º–µ–Ω—è–µ—Ç –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π LSTM –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π.
5. **Transformer Encoder Blocks**: –ü—Ä–∏–º–µ–Ω—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–ª–æ–∫–æ–≤ Transformer Encoder –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
6. **Abs Diff Layer**: –í—ã—á–∏—Å–ª—è–µ—Ç –∞–±—Å–æ–ª—é—Ç–Ω—É—é —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º–∏ –¥–≤—É—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π.
7. **Fully Connected Layers**: –ü—Ä–∏–º–µ–Ω—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã—Ö —Å–ª–æ–µ–≤ –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å.

#### Training

–ú–æ–¥–µ–ª—å `–æ–±—É—á–∞–µ—Ç—Å—è` —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–æ–≤:

1. –ó–∞–≥—Ä—É–∂–∞–µ–º –∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ: –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è [–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ](https://github.com/brainteaser-ov/diplom/blob/main/positive_test.txt) –∏ [–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ](https://github.com/brainteaser-ov/diplom/blob/main/negative_test.txt) –ø—Ä–∏–º–µ—Ä—ã –∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–ª–æ–≤–∞—Ä—å —Å–∏–º–≤–æ–ª–æ–≤.
   
> [!IMPORTANT]
> –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏, —Ç–∞–∫ –∫–∞–∫ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–≥—Ä—É–∑–∏—Ç—å –∏—Ö

3. –û–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä: –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è —Ç–∞–∫–∏–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–∞–∫ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö, —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä.
4. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏: –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ü–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è, –≤ —Ö–æ–¥–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å –∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏.
5. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Ç–µ—Ä—å: –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è.
6. –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: –º–æ–¥–µ–ª—å –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
7. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏: –û–±—É—á–µ–Ω–Ω–∞—è [–º–æ–¥–µ–ª—å](https://github.com/brainteaser-ov/diplom/blob/main/model.pth) —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ñ–∞–π–ª.

## Usage

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è: 
```
python
import torch
from your_model import SiameseModel

‚ñéLoad the saved model
model = SiameseModel(vocab_size, embedding_dim, max_len)
model.load_state_dict(torch.load('model.pth'))
model.to(device)

‚ñéPrepare the input sequences
sequence1 = "This is the first sequence."
sequence2 = "This is the second sequence."

‚ñéConvert the sequences to tensors
input_a = torch.tensor([char_tokenizer(sequence1)], dtype=torch.long, device=device)
input_b = torch.tensor([char_tokenizer(sequence2)], dtype=torch.long, device=device)

‚ñéForward pass through the model
output = model(input_a, input_b)
probability = torch.sigmoid(output).item()

print(f"Probability of the two sequences being similar: {probability:.4f}")

```

### –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

#### –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –ø–µ—Ä–µ–π—Ç–∏ –≤ –Ω–µ–≥–æ –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ
```
git clone git@github.com:{name}}/{name}
```


#### –°—Ç–µ–∫
![Python](https://img.shields.io/badge/python-3670A0?style=for-the-badge&logo=python&logoColor=ffdd54) 
![PyTorch](https://img.shields.io/badge/PyTorch-%23EE4C2C.svg?style=for-the-badge&logo=PyTorch&logoColor=white)

#### Directed by 


[brainteaser-ov üíõ](https://github.com/brainteaser-ov)  
